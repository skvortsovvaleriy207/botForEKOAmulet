# –≠–ö–û–∞–º—É–ª–µ—Ç Telegram Bot v4.0

Telegram –±–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ "–≠–ö–û–∞–º—É–ª–µ—Ç" ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Ä–º–æ–∫–æ–º–ø–æ–∑–∏—Ç–∞. –ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–∏–µ–º –∑–∞–∫–∞–∑–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Google Sheets –¥–ª—è —É—á–µ—Ç–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤, –∞ —Ç–∞–∫–∂–µ –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ –ÆKassa.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

*   üõçÔ∏è **E-commerce**: –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞, —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–∫–∏.
*   ‚≠ê **–û—Ç–∑—ã–≤—ã**: –≠—Ç–∞–ø "Social Proof" –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π ‚Äî –ø–æ–∫–∞–∑ –æ—Ç–∑—ã–≤–æ–≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
*   üí≥ **–ü–ª–∞—Ç–µ–∂–∏**: –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ÆKassa (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫ + Webhook).
*   üìä **–£—á–µ—Ç**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤ —Å Google Sheets (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `gspread`).
*   üîó **Deep Linking**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `t.me/bot?start=ref123`).
*   üõ°Ô∏è **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: Retry logic –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API, –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏, —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
*   üì¢ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –û–ø–æ–≤–µ—â–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö.
*   üö® **Low Stock Alerts**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –æ—Å—Ç–∞—Ç–∫–∞ –¥–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è (—Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏).
*   ‚è≥ **–õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞.
*   üá∑üá∫ **–í–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –†–§ (–ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏–∑ `russian_keywords.json`).
*   ü§ù **–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –†–∞–∑–¥–µ–ª "–ü–æ–º–æ—á—å –ø—Ä–æ–µ–∫—Ç—É" (`/help_project`) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–¥–∞—Ä–∏—Ç—å –∞–º—É–ª–µ—Ç –∏–ª–∏ —Å—Ç–∞—Ç—å –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–º.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone <your-repo-url>
    cd botForEKOAmulet
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
    ```bash
    python3 -m venv venv
    source venv/bin/activate  # Linux/macOS
    # venv\Scripts\activate  # Windows
    ```

3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

    ```bash
    cp .env.example .env
    ```

    –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:
    
    ### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    - `TELEGRAM_BOT_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –æ—Ç @BotFather
    - `ADMIN_TELEGRAM_ID`: –í–∞—à Telegram ID (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
    - `ADMIN_CHAT_ID`: ID —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞ –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–æ–±—ã—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ADMIN_TELEGRAM_ID)
    
    ### –ÆKassa (–ü–ª–∞—Ç–µ–∂–∏)
    - `YOOKASSA_API_KEY`: –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á API (Secter Key) –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ÆKassa
    - `YOOKASSA_SHOP_ID`: ID –º–∞–≥–∞–∑–∏–Ω–∞ (Shop ID)
    - `WEBHOOK_URL`: –ü—É–±–ª–∏—á–Ω—ã–π URL –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ + `/webhook` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://example.com/webhook`)
    - `WEBHOOK_SECRET`: –°–µ–∫—Ä–µ—Ç –≤–µ–±—Ö—É–∫–∞ (–ª—é–±–∞—è —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã)
    - `BOT_RETURN_URL`: –°—Å—ã–ª–∫–∞, –∫—É–¥–∞ –≤–µ—Ä–Ω–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://t.me/your_bot`)
    
    ### Google Sheets (–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
    - `GOOGLE_SHEET_ID`: ID –≤–∞—à–µ–π Google —Ç–∞–±–ª–∏—Ü—ã (–∏–∑ URL)
    
    ### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ª–æ–≥–∏–∫–∏
    - `PRODUCT_NAME`: –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (–∞–º—É–ª–µ—Ç–∞)
    - `PRODUCT_PRICE`: –¶–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)
    - `LOW_STOCK_THRESHOLD`: –ü–æ—Ä–æ–≥ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –º–∞–ª–æ–º –æ—Å—Ç–∞—Ç–∫–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)
    - `CRITICAL_STOCK_THRESHOLD`: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ –æ—Å—Ç–∞—Ç–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)
    
    ### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã)
    - `PRODUCT_NAME_CERT_DIGITAL`: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    - `PRODUCT_PRICE_CERT_DIGITAL`: –¶–µ–Ω–∞ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    - `PRODUCT_NAME_CERT_BOX`: –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∞—Ä–æ—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
    - `PRODUCT_PRICE_CERT_BOX`: –¶–µ–Ω–∞ –ø–æ–¥–∞—Ä–æ—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
    - `PRODUCT_NAME_CERT_SPECIAL_DIGITAL`: –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∑–Ω–æ—Å–∞ (—Ç–≤–æ—Ä—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞)
    - `PRODUCT_PRICE_CERT_SPECIAL_DIGITAL`: –°–µ–º–º–∞ –≤–∑–Ω–æ—Å–∞
    - `PRODUCT_NAME_CERT_SPECIAL_BOX`: –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ (–∏—Å—Ç–æ—Ä–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
    - `PRODUCT_PRICE_CERT_SPECIAL_BOX`: –¶–µ–Ω–∞ –Ω–∞–±–æ—Ä–∞


2.  **Google Sheets**:
    - –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –∫–ª—é—á–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ `creds.json` –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.
    - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫ –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ.
    - –¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏: `–û—Å—Ç–∞—Ç–∫–∏`, `–ó–∞–∫–∞–∑—ã`, `–û–∂–∏–¥–∞–Ω–∏–µ`.
    
3.  **–í–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤**:
    - –°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–¥—Ä–µ—Å–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `russian_keywords.json`.
    - –í—ã –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª, –¥–æ–±–∞–≤–ª—è—è –∏–ª–∏ —É–¥–∞–ª—è—è –≥–æ—Ä–æ–¥–∞ –∏ —Ä–µ–≥–∏–æ–Ω—ã.

## –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
```bash
python3 bot.py
```
*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è —Ä–∞–±–æ—Ç—ã –≤–µ–±—Ö—É–∫–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok.*

### –ó–∞–ø—É—Å–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Production)
–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é, –Ω–∞—Å—Ç—Ä–æ–π–∫–µ SSL –∏ Nginx –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ:
üìÑ **[deployment_guide.md](deployment_guide.md)**

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

*   `bot.py` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞ –∏ –ª–æ–≥–∏–∫–∏ –±–æ—Ç–∞.
*   `sheets_handler.py` ‚Äî –ú–æ–¥—É–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Google Sheets (gspread).
*   `requirements.txt` ‚Äî –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
*   `creds.json` ‚Äî –ö–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ Google (–Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ git!).
*   `.env` ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ git!).
*   `deployment_guide.md` ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

*   –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `python-telegram-bot` (v20+).
*   –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ–±—Ö—É–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `aiohttp`.
*   –ü–ª–∞—Ç–µ–∂–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É `yookassa`.
